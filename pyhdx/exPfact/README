This is the (adapted) code from Skinner:
https://github.com/skinnersp/exPfact
